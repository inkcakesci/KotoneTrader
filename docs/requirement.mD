# 项目需求文档

## 项目概述
旨在开发一套高度自定义的量化交易系统.

## 功能模块

### 1. 数据分析模块（feature/data_analysis）
- **目标**：基于随机过程和统计学理论，复现常见交易软件中的技术指标，并扩展分析功能，提供更强的自定义能力。
- **核心功能**：
  - 实现常见的技术分析指标，如移动平均线、MACD、RSI等，并允许用户根据需求进行深度自定义。
  - 提供股票或标的之间的关联性分析，例如使用 \( R^2 \) 值或相关系数。
  - 扩展至更高阶的统计分析方法，如 GARCH（广义自回归条件异方差）模型、ARIMA（自回归积分滑动平均）模型等，以捕捉时间序列的波动特性。

### 2. 数据获取模块（feature/data_fetcher）
- **目标**：通过不同数据源（如 Yahoo API 和 IBKR API）实时获取市场数据，并将数据存储到 SQLite 数据库中。
- **核心功能**：
  - 已实现 Yahoo API 和 IBKR API 的对接（需要实际开户并入金）以输入数据至 SQLite 数据库。
  - 支持自选表（watchlist）功能，允许用户管理感兴趣的标的。
  - 支持异步数据获取以提高系统响应速度。
  - 通过 Yahoo API 实现 15 分钟延迟的实时数据更新。
- **重点功能**：
  - 提供完善的日线和小时线数据支持（考虑到大部分散户都只使用日 K 和小时 K ），可能需要考虑创建SQL的视图将小时 K 数据转化为日 K 存储。
  - 与数据分析模块对接，确保时间间隔的正确性，避免数据在日线和小时线之间混淆。

### 3. 风险控制模块（feature/risk_asm）
- **目标**：在交易过程中进行实时风险评估，避免用户在高风险情况下下单，保障账户的安全性。
- **核心功能**：
  - 风险评估：在用户发出下单请求时，实时调用风险控制模块对当前仓位和市场情况进行评估，判断是否允许下单。
  - 风险提示：在检测到风险较大时，提示用户可能面临的风险，并建议用户重新审视交易决策。
  - 强制平仓（close position）信号：在极端风险情况下，自动触发平仓操作，确保用户资产的安全性。
- **扩展功能**：可以让用户分为低、中、高、无限制的四个等级风险控制。

---

## 项目结构

还在想...

---

## 现存问题
由于初始构建是基于一个较为粗糙的“轮子”，许多实现方法较为简单，主要是为了自用，缺乏良好的对象化设计和模块化结构，存在较多重复代码，难以维护扩展。

接下来需要逐步改进代码架构，将过程编程转换为面向对象编程（OOP）。

---

## 未来扩展
1. **数据可视化**：在`fetch_ib_realtime`的基础上，提供实时图表。
2. **用户权限管理**：加入不同用户的权限设置和管理模块，确保系统的安全性。
3. **多因子模型**：在风险控制模块中加入多因子风险模型，增强风险评估的准确性。
4. **系统性能优化**：通过并行处理和缓存机制，提高系统响应速度，优化用户体验。
5. **Multi-Agent集成**：希望能够复现一个Multi-Agent的不同策略之间的互相优化。
